__________________________________________________________________________

README!

This repository contains a three-step analysis pipeline
for classifying drug combinations into clusters with potential
therapeutic benefits to non-small cell lung cancer. Each step
is an independent script that must be executed in the order shown below.
__________________________________________________________________________

PIPELINE OVERVIEW

Step 1 : 1_network_propagation.R
• Language : R
• Purpose : Propagate drug-target signals through an A549-specific
protein-interaction network using Random Walk with Restart
• Main inputs : gene_interaction_cancer_subnetwork.csv
subnetwork_nodes.csv
Drug_Combination_A549.xlsx
DrugCombInationID.csv
• Main output : Network_Propagation_Result_alpha0.5.csv
(plus log-transformed & –log-transformed copy)

Step 2 : 2_gnmf_clustering.py
• Language : Python
• Purpose : Run graph-regularised NMF (λ = 0.9) to learn metagenes,
select the optimal component count (elbow method),
cluster drug pairs, and merge the cluster labels with
synergy scores
• Main inputs : Network_Propagation_Result_alpha0.5(-log).csv
gene_interaction_cancer_subnetwork.csv
Drug_Combination_A549.xlsx
• Main output : GNMF_Clustering_alpha0.5_lambda0.9.csv

Step 3 : 3_correlation_permutation.R
• Language : R
• Purpose : Within every GNMF-derived cluster, identify genes whose
propagated scores correlate strongly (|ρ| ≥ 0.7) with each
of four synergy metrics and perform a 10 000-trial
permutation test; adjust p-values to q-values (FDR)
• Main inputs : GNMF_Clustering_alpha0.5_lambda0.9.csv
Network_Propagation_Result_alpha0.5(log).csv
• Main output : df.report (data-frame in R; export to CSV if desired)
__________________________________________________________________________

DETAIL OF REQUIRED INPUT FILES

• gene_interaction_cancer_subnetwork.csv
Edge list (source, target) for the 2 100-node A549 protein-interaction sub-network

• subnetwork_nodes.csv
Mapping table: node index → HGNC gene symbol

• Drug_Combination_A549.xlsx
Metadata for 607 drug pairs – IDs, Drug A/B names, target node indices,
and four synergy scores (synergy_zip, synergy_loewe, synergy_hsa, synergy_bliss)

Column Meaning

block_id: numerical drug combination ID from drugcomb.org
DrugBank_ID_row: drug ID of row compound in DrugBank
drug_row: standardized name of row compound refer to drugbank.com
TargetGene_row: the row number of the target genes of row compound which is matching in the nodes of the network. See in subnetwork_nodes.csv
DrugBank_ID_col: drug ID of column compound in DrugBank
drug_col: standardized name of column compound refer to drugbank.com
TargetGene_col: the row number of the target genes of column compound which is matching in the nodes of the network. See in subnetwork_nodes.csv
CombineTargets: sorted and combined the row number of the target genes of both row and column compound
uniqueCombineTargets: sorted and remove duplicated of the row number of the target genes of combinations
uniqueCombineTargetGenes: converted the row number of the target genes of combinations to gene symbols
DNA_targetingByDrugs: 0;Neither drug has a DNA targeting, 1;one of the drugs has DNA targeting, 2;Both drugs target DNA. 
cell_line_name: A549 (human non-small cell lung cancer cell line)
synergy_zip: ZIP score is the % inhibition that is more than the expected effect when the two drugs do not potentiate each other
synergy_loewe: LOEWE synergy score is the % inhibition that is more than the expected effect when the two drugs are the same (drug was combined with itself)
synergy_hsa: HSA synergy score is the % inhibition that is more than expected as the highest single drug effect
synergy_bliss: BLISS synergy score is the % inhibition that is more than the expected effect when the two drugs act in probabilistic independence

• DrugCombInationID.csv
One-column list of the 607 drug-pair IDs (used as column headers)

• Network_Propagation_Result_alpha0.5.csv
Generated by Step 1; propagated profile matrix (genes × drug pairs)

• Network_Propagation_Result_alpha0.5(-log).csv
Log-transformed copy of the file above

• GNMF_Clustering_alpha0.5_lambda0.9.csv
Cluster labels merged with synergy scores (output of Step 2)









































